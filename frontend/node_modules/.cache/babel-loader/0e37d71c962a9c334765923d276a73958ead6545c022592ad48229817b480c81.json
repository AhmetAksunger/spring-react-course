{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/90538/Desktop/spring-react-course/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/90538/Desktop/spring-react-course/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/90538/Desktop/spring-react-course/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from\"react\";import Input from\"../components/input\";import{useTranslation}from\"react-i18next\";import{login,setAuthorizationHeader}from\"../api/apiCalls\";import ButtonWithProgress from\"../components/ButtonWithProgress\";import{withApiProgress}from\"../shared/ApiProgress\";import{useDispatch}from\"react-redux\";import{loginSuccess}from\"../redux/authActions\";//import { Authentication } from \"../shared/AuthenticationContext\";\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var UserLoginPage=function UserLoginPage(props){var _useState=useState(),_useState2=_slicedToArray(_useState,2),username=_useState2[0],setUsername=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),error=_useState6[0],setError=_useState6[1];var dispatch=useDispatch();// a hook function that will be executed if any effects occurs on the spesificed fields\nuseEffect(function(){setError(undefined);},[username,password]);var onClickLogin=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){var creds,response,authState;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:setError(undefined);event.preventDefault();creds={username:username,password:password};_context.prev=3;_context.next=6;return login(creds);case 6:response=_context.sent;props.history.push(\"/\");authState={username:response.data.user.username,displayName:response.data.user.displayName,image:response.data.user.image,password:password,token:response.data.token};dispatch(loginSuccess(authState));_context.next=15;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](3);setError(_context.t0.response.data.message);case 15:case\"end\":return _context.stop();}},_callee,null,[[3,12]]);}));return function onClickLogin(_x){return _ref.apply(this,arguments);};}();var _useTranslation=useTranslation(),t=_useTranslation.t;var pendingApiCall=props.pendingApiCall;return/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-center\",children:t(\"Login\")}),/*#__PURE__*/_jsx(Input,{type:\"text\",name:\"username\",label:t(\"Username\"),onChange:function onChange(event){setUsername(event.target.value);}}),/*#__PURE__*/_jsx(Input,{type:\"password\",name:\"password\",label:t(\"Password\"),onChange:function onChange(event){setPassword(event.target.value);}}),error?/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-danger mt-3\",children:error}):/*#__PURE__*/_jsx(\"div\",{}),/*#__PURE__*/_jsx(ButtonWithProgress,{buttonText:t(\"Login\"),onClickMethod:onClickLogin,pendingApiCall:pendingApiCall,disabledStatement:!username||!password||pendingApiCall})]})});};var LoginPageWithApiProgress=withApiProgress(UserLoginPage,\"post\",\"/api/1.0/auth\");export default LoginPageWithApiProgress;","map":{"version":3,"names":["React","useEffect","useState","Input","useTranslation","login","setAuthorizationHeader","ButtonWithProgress","withApiProgress","useDispatch","loginSuccess","jsx","_jsx","jsxs","_jsxs","UserLoginPage","props","_useState","_useState2","_slicedToArray","username","setUsername","_useState3","_useState4","password","setPassword","_useState5","_useState6","error","setError","dispatch","undefined","onClickLogin","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","event","creds","response","authState","wrap","_callee$","_context","prev","next","preventDefault","sent","history","push","data","user","displayName","image","token","t0","message","stop","_x","apply","arguments","_useTranslation","t","pendingApiCall","className","children","type","name","label","onChange","target","value","buttonText","onClickMethod","disabledStatement","LoginPageWithApiProgress"],"sources":["C:/Users/90538/Desktop/spring-react-course/frontend/src/pages/UserLoginPage.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport Input from \"../components/input\"\r\nimport { useTranslation } from \"react-i18next\"\r\nimport { login, setAuthorizationHeader } from \"../api/apiCalls\";\r\nimport ButtonWithProgress from \"../components/ButtonWithProgress\";\r\nimport { withApiProgress } from \"../shared/ApiProgress\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { loginSuccess } from \"../redux/authActions\";\r\n//import { Authentication } from \"../shared/AuthenticationContext\";\r\n\r\n\r\nconst UserLoginPage = (props) => {\r\n\r\n    const [username, setUsername] = useState();\r\n    const [password, setPassword] = useState();\r\n    const [error,  setError] = useState();\r\n\r\n    const dispatch = useDispatch();\r\n\r\n    // a hook function that will be executed if any effects occurs on the spesificed fields\r\n    useEffect(() => {\r\n        setError(undefined)\r\n    }, [username, password])\r\n\r\n    const onClickLogin = async event =>{\r\n\r\n        setError(undefined)\r\n\r\n        event.preventDefault();\r\n\r\n        const creds = {\r\n            username: username,\r\n            password: password\r\n        }\r\n\r\n        try {\r\n            const response = await login(creds);\r\n            props.history.push(\"/\");\r\n\r\n            const authState = {\r\n                username: response.data.user.username,\r\n                displayName: response.data.user.displayName,\r\n                image: response.data.user.image,\r\n                password: password,\r\n                token: response.data.token\r\n            }\r\n            \r\n            dispatch(loginSuccess(authState))\r\n\r\n        } catch (error) {\r\n            setError(error.response.data.message)\r\n        }\r\n    }\r\n    \r\n    const {t} = useTranslation();\r\n    const {pendingApiCall } = props\r\n    return(\r\n        <div className=\"container\">\r\n            <form>\r\n                <h1 className=\"text-center\">{t(\"Login\")}</h1>\r\n                <Input type=\"text\" name=\"username\" label={t(\"Username\")} onChange={(event) => {setUsername(event.target.value)}} />\r\n                <Input type=\"password\" name=\"password\" label={t(\"Password\")} onChange={(event) => {setPassword(event.target.value)}}/>\r\n                \r\n                {/*  ? excepts : but && doesn't except any else conditions\r\n                \r\n                    i could also use &&. In that case if this.state.error existed, it would\r\n                    write the message but else it wouldn't render anything\r\n                \r\n                */}\r\n\r\n                {error ? \r\n                <div className=\"alert alert-danger mt-3\">\r\n                {error}\r\n                </div>\r\n                :\r\n                <div></div>\r\n                }\r\n{/*                     <button className=\"btn btn-primary\" disabled={!username || !password || pendingApiCall} onClick={this.onClickLogin}>\r\n                    {pendingApiCall &&\r\n                    <span className=\"spinner-border spinner-border-sm\"></span>                    \r\n                    }\r\n                    {t(\"Login\")}\r\n                </button>*/}        \r\n\r\n                <ButtonWithProgress buttonText={t(\"Login\")} onClickMethod={onClickLogin} pendingApiCall={pendingApiCall} disabledStatement={!username || !password || pendingApiCall} />\r\n                        \r\n                </form>\r\n        </div>\r\n        \r\n    )\r\n\r\n}\r\n\r\nconst LoginPageWithApiProgress = withApiProgress(UserLoginPage,\"post\",\"/api/1.0/auth\");\r\n\r\nexport default LoginPageWithApiProgress;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}